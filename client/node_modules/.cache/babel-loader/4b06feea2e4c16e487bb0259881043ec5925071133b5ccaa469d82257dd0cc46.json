{"ast":null,"code":"import _slicedToArray from\"/home/agreus/Documents/webdev/mercury-messenger/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from\"react\";import moment from\"moment/moment\";import{ReplyIcon}from\"@heroicons/react/outline\";import ReplyViewer from\"./ReplyViewer\";import{ReplyContext}from\"../context/RepliesContext\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Sender(props){var sender=props.sender,children=props.children,timestamp=props.timestamp,pending=props.pending,mentions=props.mentions,reply=props.reply,clusterId=props.clusterId;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),replyExpanded=_useState2[0],setReplyExpanded=_useState2[1];var _useContext=useContext(ReplyContext),setReply=_useContext.setReply;var userMentioned=pending?false:mentions.some(function(user){return user._id===localStorage.userId;});var userReplied=pending||!reply?false:reply.sender._id===localStorage.userId&&sender._id!==localStorage.userId;var timeText;if(timestamp>Date.now()||Date.now()-timestamp<30000){timeText=\"just now\";}else if(Date.now()-timestamp<1.8e6){timeText=moment(timestamp).fromNow();}else timeText=moment(timestamp).calendar();var emphasis;var emphasisBackground;if(userReplied){emphasis=\"bg-sky-500\";emphasisBackground=\"bg-sky-500 hover:bg-sky-400 bg-opacity-20 hover:bg-opacity-30\";}else if(userMentioned){emphasis=\"bg-amber-500\";emphasisBackground=\"bg-amber-500 hover:bg-amber-400 bg-opacity-20 hover:bg-opacity-30\";}else{emphasis=\"\";emphasisBackground=\"hover:bg-gray-700\";}function renderMentions(){var mentionedNames=mentions.map(function(user){return user.username;});var stack=mentionedNames.reduce(function(accumulator,username,index){if(index<2){accumulator.push(/*#__PURE__*/_jsxs(\"span\",{children:[username,index===mentionedNames.length-1||\",\"]},username));}else if(index===2){accumulator.push(/*#__PURE__*/_jsxs(\"span\",{title:mentionedNames.slice(2,mentionedNames.length),children:[\"+ \",mentionedNames.length-2,\" more\"]},username));}return accumulator;},[]);return stack;}return/*#__PURE__*/_jsxs(_Fragment,{children:[!replyExpanded||/*#__PURE__*/_jsx(ReplyViewer,{reply:reply}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(emphasisBackground,\" pr-3 flex bg-opacity-25 group relative\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-1 mr-2 \".concat(emphasis,\" shrink-0\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex mt-2 mb-2 w-full relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:sender.userImage.thumbnailMedium,alt:\"profile\",className:\"w-12 h-12 mr-2 rounded-full self-start shrink-0 \".concat(pending?\"opacity-50\":null)}),pending||/*#__PURE__*/_jsx(ReplyIcon,{className:\"h-6 w-6 p-0.5 text-gray-800 bg-gray-500 hover:bg-gray-400 shadow-md opacity-0 group-hover:opacity-100 rounded-full absolute top-7 left-0 transition-opacity duration-75 ease-linear cursor-pointer\",onClick:function onClick(){return setReply({clusterId:clusterId,name:sender.username});}}),/*#__PURE__*/_jsxs(\"span\",{className:\"w-full flex flex-col overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-kanit flex items-center \".concat(pending?\"opacity-50\":null,\" overflow-hidden\"),style:{color:sender.userColor},children:[sender.username,!reply||/*#__PURE__*/_jsxs(\"span\",{className:\"h-4 max-w-[10rem] md:max-w-[15rem] lg:max-w-[20rem] text-gray-800 group-hover:text-gray-900 pl-1 text-sm flex items-center\",children:[/*#__PURE__*/_jsx(ReplyIcon,{className:\"w-3 mr-0.5 inline -scale-x-100 shrink-0\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"hover:underline cursor-pointer truncate\",onMouseEnter:function onMouseEnter(){return setReplyExpanded(true);},onMouseLeave:function onMouseLeave(){return setReplyExpanded(false);},children:[reply.sender.username,\" - \\\"\",reply.lastMessage.text,\"\\\"\"]})]}),!(mentions!==null&&mentions!==void 0&&mentions.length)>0||/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-800 pl-1 text-sm\",children:[\"@\",renderMentions()]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm opacity-60 shrink-0\",children:timeText})]}),children]})]})]})]});}export default Sender;","map":{"version":3,"names":["useContext","useState","moment","ReplyIcon","ReplyViewer","ReplyContext","Sender","props","sender","children","timestamp","pending","mentions","reply","clusterId","replyExpanded","setReplyExpanded","setReply","userMentioned","some","user","_id","localStorage","userId","userReplied","timeText","Date","now","fromNow","calendar","emphasis","emphasisBackground","renderMentions","mentionedNames","map","username","stack","reduce","accumulator","index","push","length","slice","userImage","thumbnailMedium","name","color","userColor","lastMessage","text"],"sources":["/home/agreus/Documents/webdev/mercury-messenger/client/src/components/chat/SenderWrapper.js"],"sourcesContent":["import { useContext, useState } from \"react\";\nimport moment from \"moment/moment\";\n\nimport { ReplyIcon } from \"@heroicons/react/outline\";\n\nimport ReplyViewer from \"./ReplyViewer\";\n\nimport { ReplyContext } from \"../context/RepliesContext\";\n\nfunction Sender(props) {\n  const { sender, children, timestamp, pending, mentions, reply, clusterId } =\n    props;\n\n  const [replyExpanded, setReplyExpanded] = useState(false);\n\n  const { setReply } = useContext(ReplyContext);\n\n  const userMentioned = pending\n    ? false\n    : mentions.some((user) => user._id === localStorage.userId);\n\n  const userReplied =\n    pending || !reply\n      ? false\n      : reply.sender._id === localStorage.userId &&\n        sender._id !== localStorage.userId;\n\n  let timeText;\n  if (timestamp > Date.now() || Date.now() - timestamp < 30000) {\n    timeText = \"just now\";\n  } else if (Date.now() - timestamp < 1.8e6) {\n    timeText = moment(timestamp).fromNow();\n  } else timeText = moment(timestamp).calendar();\n\n  let emphasis;\n  let emphasisBackground;\n  if (userReplied) {\n    emphasis = \"bg-sky-500\";\n    emphasisBackground =\n      \"bg-sky-500 hover:bg-sky-400 bg-opacity-20 hover:bg-opacity-30\";\n  } else if (userMentioned) {\n    emphasis = \"bg-amber-500\";\n    emphasisBackground =\n      \"bg-amber-500 hover:bg-amber-400 bg-opacity-20 hover:bg-opacity-30\";\n  } else {\n    emphasis = \"\";\n    emphasisBackground = \"hover:bg-gray-700\";\n  }\n\n  function renderMentions() {\n    const mentionedNames = mentions.map((user) => user.username);\n    const stack = mentionedNames.reduce((accumulator, username, index) => {\n      if (index < 2) {\n        accumulator.push(\n          <span key={username}>\n            {username}\n            {index === mentionedNames.length - 1 || \",\"}\n          </span>\n        );\n      } else if (index === 2) {\n        accumulator.push(\n          <span\n            key={username}\n            title={mentionedNames.slice(2, mentionedNames.length)}\n          >\n            + {mentionedNames.length - 2} more\n          </span>\n        );\n      }\n      return accumulator;\n    }, []);\n    return stack;\n  }\n\n  return (\n    <>\n      {!replyExpanded || <ReplyViewer reply={reply} />}\n      <div\n        className={`${emphasisBackground} pr-3 flex bg-opacity-25 group relative`}\n      >\n        <span className={`w-1 mr-2 ${emphasis} shrink-0`}></span>\n        <div className=\"flex mt-2 mb-2 w-full relative\">\n          <img\n            src={sender.userImage.thumbnailMedium}\n            alt=\"profile\"\n            className={`w-12 h-12 mr-2 rounded-full self-start shrink-0 ${\n              pending ? \"opacity-50\" : null\n            }`}\n          />\n          {pending || (\n            <ReplyIcon\n              className=\"h-6 w-6 p-0.5 text-gray-800 bg-gray-500 hover:bg-gray-400 shadow-md opacity-0 group-hover:opacity-100 rounded-full absolute top-7 left-0 transition-opacity duration-75 ease-linear cursor-pointer\"\n              onClick={() => setReply({ clusterId, name: sender.username })}\n            />\n          )}\n          <span className=\"w-full flex flex-col overflow-hidden\">\n            <div className=\"flex justify-between items-center\">\n              <span\n                className={`font-kanit flex items-center ${\n                  pending ? \"opacity-50\" : null\n                } overflow-hidden`}\n                style={{ color: sender.userColor }}\n              >\n                {sender.username}\n                {!reply || (\n                  <span className=\"h-4 max-w-[10rem] md:max-w-[15rem] lg:max-w-[20rem] text-gray-800 group-hover:text-gray-900 pl-1 text-sm flex items-center\">\n                    <ReplyIcon className=\"w-3 mr-0.5 inline -scale-x-100 shrink-0\" />\n                    <span\n                      className=\"hover:underline cursor-pointer truncate\"\n                      onMouseEnter={() => setReplyExpanded(true)}\n                      onMouseLeave={() => setReplyExpanded(false)}\n                    >\n                      {reply.sender.username} - \"{reply.lastMessage.text}\"\n                    </span>\n                  </span>\n                )}\n                {!mentions?.length > 0 || (\n                  <span className=\"text-gray-800 pl-1 text-sm\">\n                    @{renderMentions()}\n                  </span>\n                )}\n              </span>\n              <span className=\"text-sm opacity-60 shrink-0\">{timeText}</span>\n            </div>\n            {children}\n          </span>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default Sender;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}