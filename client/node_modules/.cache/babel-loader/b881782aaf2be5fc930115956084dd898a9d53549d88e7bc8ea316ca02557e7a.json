{"ast":null,"code":"import _slicedToArray from\"/home/agreus/Documents/webdev/mercury-messenger/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useNavigate}from\"react-router-dom\";import{useContext,useState}from\"react\";// components\nimport NewGroupForm from\"../components/forms/NewGroupForm\";import JoinByInvite from\"../components/forms/JoinByInvite\";// context\nimport{DataContext}from\"../components/context/DataContext\";import{FlashContext}from\"../components/context/FlashContext\";// utility hooks\nimport axiosInstance from\"../utils/axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NewGroupPage(){var _useContext=useContext(DataContext),dataHelpers=_useContext.dataHelpers,setSelectedGroup=_useContext.setSelectedGroup,setSelectedChannel=_useContext.setSelectedChannel;var _useContext2=useContext(FlashContext),pushFlashMessage=_useContext2.pushFlashMessage;var _useState=useState({message:null,status:null}),_useState2=_slicedToArray(_useState,2),axiosCreateErr=_useState2[0],setAxiosCreateErr=_useState2[1];var _useState3=useState({message:null,status:null}),_useState4=_slicedToArray(_useState3,2),axiosJoinErr=_useState4[0],setAxiosJoinErr=_useState4[1];var _axiosInstance=axiosInstance(),userGroups=_axiosInstance.userGroups;var navigate=useNavigate();function newGroupHandler(groupObject){var newGroupData=new FormData();newGroupData.append(\"name\",groupObject.name);newGroupData.append(\"file\",groupObject.image);userGroups.new(newGroupData).then(function(res){dataHelpers.addNewGroup(res.data.newGroup);setSelectedGroup(res.data.newGroup);setSelectedChannel(null);pushFlashMessage(res.data.messages);navigate(\"/g/\".concat(res.data.newGroup.name));}).catch(function(err){setAxiosCreateErr({message:err.response.data.messages[0].message});});}function joinGroupHandler(joinCode){userGroups.join(joinCode).then(function(res){dataHelpers.addNewGroup(res.data.joinedGroup,res.data.chatData,res.data.chatDepleted);dataHelpers.mergePeers(res.data.peerData);setSelectedGroup(res.data.joinedGroup);setSelectedChannel(null);pushFlashMessage(res.data.messages);navigate(\"/g/\".concat(res.data.joinedGroup.name));}).catch(function(err){setAxiosJoinErr({message:err.response.data.messages[0].message});});}return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-700 w-full flex flex-col p-2 justify-evenly items-center bgHeroDiagDark\",children:[/*#__PURE__*/_jsx(NewGroupForm,{onNewGroup:newGroupHandler,err:axiosCreateErr}),/*#__PURE__*/_jsx(JoinByInvite,{onJoinGroup:joinGroupHandler,err:axiosJoinErr})]});}export default NewGroupPage;","map":{"version":3,"names":["useNavigate","useContext","useState","NewGroupForm","JoinByInvite","DataContext","FlashContext","axiosInstance","NewGroupPage","dataHelpers","setSelectedGroup","setSelectedChannel","pushFlashMessage","message","status","axiosCreateErr","setAxiosCreateErr","axiosJoinErr","setAxiosJoinErr","userGroups","navigate","newGroupHandler","groupObject","newGroupData","FormData","append","name","image","new","then","res","addNewGroup","data","newGroup","messages","catch","err","response","joinGroupHandler","joinCode","join","joinedGroup","chatData","chatDepleted","mergePeers","peerData"],"sources":["/home/agreus/Documents/webdev/mercury-messenger/client/src/pages/NewGroupPage.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\nimport { useContext, useState } from \"react\";\n// components\nimport NewGroupForm from \"../components/forms/NewGroupForm\";\nimport JoinByInvite from \"../components/forms/JoinByInvite\";\n// context\nimport { DataContext } from \"../components/context/DataContext\";\nimport { FlashContext } from \"../components/context/FlashContext\";\n// utility hooks\nimport axiosInstance from \"../utils/axios\";\n\nfunction NewGroupPage() {\n  const { dataHelpers, setSelectedGroup, setSelectedChannel } =\n    useContext(DataContext);\n  const { pushFlashMessage } = useContext(FlashContext);\n  const [axiosCreateErr, setAxiosCreateErr] = useState({\n    message: null,\n    status: null,\n  });\n  const [axiosJoinErr, setAxiosJoinErr] = useState({\n    message: null,\n    status: null,\n  });\n  const { userGroups } = axiosInstance();\n  const navigate = useNavigate();\n\n  function newGroupHandler(groupObject) {\n    let newGroupData = new FormData();\n    newGroupData.append(\"name\", groupObject.name);\n    newGroupData.append(\"file\", groupObject.image);\n\n    userGroups\n      .new(newGroupData)\n      .then((res) => {\n        dataHelpers.addNewGroup(res.data.newGroup);\n\n        setSelectedGroup(res.data.newGroup);\n        setSelectedChannel(null);\n\n        pushFlashMessage(res.data.messages);\n        navigate(`/g/${res.data.newGroup.name}`);\n      })\n      .catch((err) => {\n        setAxiosCreateErr({\n          message: err.response.data.messages[0].message,\n        });\n      });\n  }\n\n  function joinGroupHandler(joinCode) {\n    userGroups\n      .join(joinCode)\n      .then((res) => {\n        dataHelpers.addNewGroup(\n          res.data.joinedGroup,\n          res.data.chatData,\n          res.data.chatDepleted\n        );\n        dataHelpers.mergePeers(res.data.peerData);\n\n        setSelectedGroup(res.data.joinedGroup);\n        setSelectedChannel(null);\n\n        pushFlashMessage(res.data.messages);\n        navigate(`/g/${res.data.joinedGroup.name}`);\n      })\n      .catch((err) => {\n        setAxiosJoinErr({\n          message: err.response.data.messages[0].message,\n        });\n      });\n  }\n\n  return (\n    <div className=\"bg-gray-700 w-full flex flex-col p-2 justify-evenly items-center bgHeroDiagDark\">\n      <NewGroupForm onNewGroup={newGroupHandler} err={axiosCreateErr} />\n      <JoinByInvite onJoinGroup={joinGroupHandler} err={axiosJoinErr} />\n    </div>\n  );\n}\n\nexport default NewGroupPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}